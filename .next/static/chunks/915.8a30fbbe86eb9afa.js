"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{915:function(e,r,t){t.r(r),t.d(r,{default:function(){return c}});var n=t(3761),a=t(8558),l=t(6630),o=t.n(l);function c(e){let{isDrawing:r,onAreaCalculated:t,onClear:l}=e,c=(0,a.useRef)(null),s=(0,a.useRef)(null),u=(0,a.useRef)(null),[i,g]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{g(!0)},[]),(0,a.useEffect)(()=>{if(!i)return;if(!c.current){console.log("[v0] Initializing Leaflet map");let r=o().map("map").setView([-15.6014,-56.0979],13);o().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(r),c.current=r;let t=new(o()).FeatureGroup;r.addLayer(t),s.current=t;let n=new(o()).Control.Draw({edit:{featureGroup:t},draw:{polygon:{allowIntersection:!1,showArea:!0},polyline:!1,rectangle:{},circle:!1,marker:!1,circlemarker:!1}});u.current=n,r.on(o().Draw.Event.CREATED,r=>{console.log("[v0] Shape created, calculating area");let n=r.layer;t.addLayer(n),e()}),r.on(o().Draw.Event.EDITED,()=>{console.log("[v0] Shapes edited, recalculating area"),e()}),r.on(o().Draw.Event.DELETED,()=>{console.log("[v0] Shapes deleted, recalculating area"),e()})}let e=()=>{if(!s.current)return;let e=0,r=[];s.current.eachLayer(t=>{if(t instanceof o().Polygon||t instanceof o().Rectangle){let n=t.getLatLngs()[0]||t.getLatLngs(),a=o().GeometryUtil.geodesicArea(n);e+=a/1e4,r.push(t.toGeoJSON())}}),t(e,r)};return()=>{c.current&&(console.log("[v0] Cleaning up map instance"),c.current.remove(),c.current=null)}},[i,t]),(0,a.useEffect)(()=>{c.current&&u.current&&(r?(console.log("[v0] Enabling draw controls"),c.current.addControl(u.current)):(console.log("[v0] Disabling draw controls"),c.current.removeControl(u.current)))},[r]),(0,a.useEffect)(()=>{l&&s.current&&(console.log("[v0] Clearing all drawn shapes"),s.current.clearLayers(),t(0,[]))},[l,t]),i)?(0,n.jsx)("div",{id:"map",className:"w-full h-full"}):null}t(8393),t(5230),t(4899),delete o().Icon.Default.prototype._getIconUrl,o().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"})}}]);